function AddLine(e){var t=e.parentNode,n=t.parentNode,r=t.querySelector("input"),l=0,a=n.querySelectorAll("input");for(i=0;i<a.length;i++)l=Math.max(a[i].dataset.id,l);0==l&&n.appendChild(document.createElement("div"));var o=t.nextSibling,c=o.insertBefore(GenInputLine(getSiteName(e),1*l+1,t.dataset.listname,r.value),o.querySelector("div:first-child"));r.classList.contains("error")&&(c.querySelector("input").classList.add("error"),r.classList.remove("error")),r.value=""}function DisableTabs(){var e,t,n,r="";if(n=document.querySelectorAll(".option-default input:checked"),1==n.length){for(var l=n[0];"TR"!=l.tagName;)l=l.parentNode;l.style.display="none"}for(t=0;t<n.length;t++)if("yes"==n[t].value){r=getSiteName(n[t]);break}for(t=0;t<n.length;t++)e=getSiteName(n[t]),""==r||e==r?tabControl.EnableTab("settings_"+e):tabControl.DisableTab("settings_"+e);""!=r&&tabControl.SelectTab("settings_"+r)}function checkCustomColor(e){var t=e.value.toLowerCase(),n=getParentTable(e),r=n.querySelector(".colors .option-element:last-child");e.value=t=t.replace(/[^0-9a-f]/g,"").replace(/^(.{6}).*/,"$1"),t.match(/^([0-9a-f]{3}|[0-9a-f]{6})$/)?(r.style.display="inline-block",r.querySelector("div").style.backgroundColor="#"+t,r.querySelector("input").value=t,r.click()):(r.style.display="",r.querySelector("input").checked&&n.querySelector(".colors .option-element:first-child").click())}function getParentTable(e){for(;"TABLE"!=e.tagName;)e=e.parentNode;return e}function getSiteName(e){return getParentTable(e).querySelector("tr:first-child").dataset.site}function GenInputLine(e,t,n,r){var l=document.createElement("div");return l.innerHTML='<input class="input-text" name="'+e+"["+n+"]["+t+']" value="'+r+'" data-id="'+t+'"><button class="icon-btn"><svg><use xlink:href="#del"></use></svg></button>',l}document.addEventListener("DOMContentLoaded",function(e){function t(e){e.preventDefault(),target=e.target,target.classList.contains("icon-btn")&&(target.classList.contains("add-btn")?AddLine(target):(elToDel=target.parentNode,elToDel.parentNode.removeChild(elToDel)))}var n,r,l,a,o;for(DisableTabs(),r=document.querySelectorAll(".option-element"),n=0;n<r.length;n++)r[n].addEventListener("click",function(e){for(this.querySelector("input").checked=!0,r=this.parentElement.querySelectorAll(".option-element"),n=0;n<r.length;n++)r[n].classList.remove("selected");this.classList.add("selected")}),l=r[n].querySelector("input"),1==l.checked&&r[n].classList.add("selected"),l.style.display="none";for(a=document.querySelectorAll(".colors .option-element:last-child"),n=0;n<a.length;n++)(a[n].querySelector("input").checked||""!=getParentTable(a[n]).querySelector(".custom-color input").value)&&(a[n].style.display="inline-block");for(r=document.querySelectorAll(".custom-color input"),n=0;n<r.length;n++)r[n].addEventListener("input",function(e){checkCustomColor(this)});for(r=document.querySelectorAll("button"),n=0;n<r.length;n++)r[n].addEventListener("touchstart",function(e){e.preventDefault(),t(e)});for(r=document.querySelectorAll(".list-cont"),n=0;n<r.length;n++)r[n].addEventListener("click",function(e){t(e)}),r[n].addEventListener("input",function(e){target=e.target,"INPUT"==target.tagName&&(o=new RegExp("(^([^?]*\\?{1}[^?]*){2,}$|^([^#]*#{1}[^#]*){2,}$|[^0-9a-zA-Z"+cyrRegexp+"=\\-_\\/%+,.;:*()&!$'\\?#~])"),target.value.match(o)?target.classList.contains("error")||target.classList.add("error"):target.classList.contains("error")&&target.classList.remove("error"),document.querySelector('input[name="save"]').disabled=!!getParentTable(target).querySelector(".list-cont input.error"))});for(r=document.querySelectorAll(".option-default"),n=0;n<r.length;n++)r[n].addEventListener("click",function(e){DisableTabs()});for(r=document.querySelectorAll(".dig-cont input"),n=0;n<r.length;n++)r[n].addEventListener("input",function(e){var t=e.target;t.value=t.value.replace(/[^0-9]/g,"").replace(/^(.{4}).*/,"$1")})});